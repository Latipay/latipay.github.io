

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Latipay Hosted Online</title>
    <meta charset="utf-8">
    <meta name="description" content="Latipay">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Latipay Hosted Online">
    <meta property="og:description" content="Latipay">
    <meta property="og:image" content="https://latipay.net//images/logo.png">

    <link rel="icon" href="https://merchant.latipay.net/favicon.ico">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <script>window.PAGE_TYPE = "v2"</script>

  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.svg">
  </a>

  <ul id="nav">
    <li>
  	  <a href="/api-console/index.html" class="nav-link">API Console</a>
  	</li>

    <li>
  	  <a href="/v2_cn/index.html" class="nav-link">中文</a>
  	</li>

	  <li>
	    <a href="/v2/index.html" class="nav-link">English</a>
	  </li>
  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <div class="list">
      <h2>
        V2
      </h2>
      <ul class="menu-root">
  
    <li>
      <a href="/v2/index.html" class="sidebar-link">Introduction</a>
    </li>
  
    <li>
      <a href="/v2/latipay-hosted-online.html" class="sidebar-link current">Latipay Hosted Online</a>
    </li>
  
    <li>
      <a href="/v2/merchant-hosted-offline.html" class="sidebar-link">Merchant Hosted Offline/Hardware</a>
    </li>
  
    <li>
      <a href="/v2/latipay-barcode.html" class="sidebar-link">Barcode Payment</a>
    </li>
  
    <li>
      <a href="/v2/latipay-wechat-mini-app.html" class="sidebar-link">Wechat Mini App Payment</a>
    </li>
  
    <li>
      <a href="/v2/invoice.html" class="sidebar-link">Latipay Invoice</a>
    </li>
  
    <li>
      <a href="/v2/error-code.html" class="sidebar-link">Error Code</a>
    </li>
  
</ul>

    </div>
  </div>
</div>


<div class="content v2 with-sidebar ">
  
    
      
    
  
  
    <h1>Latipay Hosted Online</h1>
  
  <p><a href="(http://doc.latipay.net/api-console/index.html?api=/v2/transaction">API Playground</a>)</p>
<p class="tip">Tips: Get your <code>Wallet ID</code>, <code>User ID</code> and <code>API key</code> via <a href="https://merchant.latipay.net/account" target="__blank">Latipay Merchant Portal</a> &gt; Account &gt; Show hidden values<br>Tips: Create a minimum amount product (e.g. $ 0.01 NZD/AUD) for testing.</p>

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>The Online / E-Commerce API is an independent Hosted Payments Page (HPP) solution provided by Latipay. The HPP provides a solution for capturing WeChat/ Alipay and 19 main Chinese banks information securely without exposing the merchant to sensitive financial data. This Hosted API provides merchants with a secure and versatile solution for online payments and enables payments by redirecting users to a Latipay Hosted Payment Page. A real-time confirmation notification of payment from Latipay will be sent to the merchants in the form of a callback notification. These notifications are handled effectively and sent to an allocated callback_url in less than <code>30s</code>. Merchants also can track payment status through the Latipay Order Query API. More available from the Merchant and Transaction portals of Latipay.</p>
<p><strong> Available Payment Methods </strong></p>
<ul>
<li>Alipay (Alipay website payment page)</li>
<li>WeChat Pay (Latipay hosted payment page)</li>
<li>16 Chinese OnlineBanks (Latipay hosted payment page)</li>
</ul>
<p><strong> Relevant Products </strong></p>
<ul>
<li>E-commerce Website</li>
</ul>
<h2 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works?"></a>How it works?</h2><p>Alipay</p>
<p><img src="../images/Merchant Hosted Online Alipay.jpeg" alt=""></p>
<hr>
<p>Wechat<br><img src="../images/latipay_hosted_online.jpg" alt=""></p>
<hr>
<p>OnlineBank</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="../images/Merchant Hosted Online Bank.jpeg" alt=""></h2><h2 id="Payment-Scenarios"><a href="#Payment-Scenarios" class="headerlink" title="Payment Scenarios"></a>Payment Scenarios</h2><ul>
<li><strong>The payment scenarios are basing on the customer using Latipay payment services by <code>PC browser</code>.</strong></li>
</ul>
<p>Merchant website checkout page</p>
<h2 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="../images/PC brower - checkout_show.png" alt=""></h2><p>Alipay<br><img src="../images/Alipay_LatipayHosted.png" alt=""></p>
<p>WeChat Pay<br><img src="../images/Wechat_LatipayHosted - web.png" alt=""></p>
<p>Online Bank</p>
<h2 id="-2"><a href="#-2" class="headerlink" title=""></a><img src="../images/Onlinebank_LatipayHosted.png" alt=""></h2><ul>
<li><strong>The payment scenario is basing on the customer using Latipay payment services by <code>Mobile browser</code></strong>, Such as Safari in iPhone.</li>
</ul>
<p>Alipay<br>The mobile browser Safari will try to launch Alipay app to make the payment. It doesn’t support Wechat pay.<br><img src="../images/Alipay_LatipayHosted - mobile browser.png" alt=""></p>
<hr>
<ul>
<li><strong>The payment scenario is basing on the customer using Latipay payment services by <code>Embedded browser in App</code>.</strong></li>
</ul>
<p>Alipay<br><img src="../images/Alipay_LatipayHosted - emebbed browser.png" alt=""></p>
<p>WeChat Pay<br><img src="../images/Wechat_LatipayHosted - phone.png" alt=""></p>
<h2 id="API-Details"><a href="#API-Details" class="headerlink" title="API Details"></a>API Details</h2><h3 id="STEP-1-Latipay-Transaction-Interface"><a href="#STEP-1-Latipay-Transaction-Interface" class="headerlink" title="STEP 1 - Latipay Transaction Interface"></a>STEP 1 - Latipay Transaction Interface</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST https://api.latipay.net/v2/transaction</span><br><span class="line">Content-Type: application/json;charset=UTF-8</span><br></pre></td></tr></table></figure>
<p>Demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl \</span><br><span class="line">-X POST \</span><br><span class="line">-H &quot;Content-Type: application/json;charset=UTF-8&quot; \</span><br><span class="line">-d &apos;&#123;&quot;user_id&quot;:&quot;U000334333&quot;,&quot;wallet_id&quot;:&quot;W00000001&quot;,&quot;amount&quot;:&quot;120.00&quot;,&quot;payment_method&quot;:&quot;alipay&quot;,&quot;return_url&quot;:&quot;https://merchantsite.com/checkout&quot;,&quot;callback_url&quot;:&quot;https://merchantsite.com/confirm&quot;,&quot;signature&quot;:&quot;8d1bea078eaacdae8388852851ec39e2e8561cdce64f359421d85ed4844496ec&quot;,&quot;merchant_reference&quot;:&quot;dsi39ej430sks03&quot;,&quot;ip&quot;:&quot;122.122.122.1&quot;,&quot;version&quot;:&quot;2.0&quot;,&quot;product_name&quot;:&quot;Pinot Noir, Otago&quot;&#125;&apos; \</span><br><span class="line">https://api.latipay.net/v2/transaction</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Attributes</strong></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>The Latipay user account which is using for processing the transactions.</td>
<td>NO</td>
</tr>
<tr>
<td>wallet_id</td>
<td>String</td>
<td>The wallet ID that using for online transactions.</td>
<td>NO</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment methods can be <code>wechat</code>, <code>alipay</code> or <code>onlineBank</code>.</td>
<td>NO</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
<td>NO</td>
</tr>
<tr>
<td>return_url</td>
<td>String</td>
<td>The URL of the landing page where the customer will be directed to after payment.</td>
<td>NO</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>Merchant webserver’s URL that the payment result will send to.</td>
<td>NO</td>
</tr>
<tr>
<td>backPage_url</td>
<td>String</td>
<td>Optional, A back link show on Latipay’s payment page. Customer can back to merchant’s website with this link.</td>
<td>YES</td>
</tr>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A <code>unique id</code> identifying the order in Merchant’s system.</td>
<td>NO</td>
</tr>
<tr>
<td>ip</td>
<td>String</td>
<td>The customer’s IP address</td>
<td>NO</td>
</tr>
<tr>
<td>version</td>
<td>String</td>
<td>The latest version of the Latipay platform which must be <code>&quot;2.0&quot;</code></td>
<td>Yes</td>
</tr>
<tr>
<td>product_name</td>
<td>String</td>
<td>The name of the product or service being sold.</td>
<td>No</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The <code>SHA-256 HMAC</code> API signature.</td>
<td>NO</td>
</tr>
</tbody>
</table>
<h4 id="Extract-Attributes-Only-for-WeChat"><a href="#Extract-Attributes-Only-for-WeChat" class="headerlink" title="Extract Attributes (Only for WeChat)"></a>Extract Attributes (<code>Only for WeChat</code>)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>present_qr</td>
<td>String</td>
<td>Must be <code>&quot;1&quot;</code>, to show a Latipay hosted page which presenting QR code waiting for scanning. It only works outside of Wechat App, such as PC browser.</td>
<td>NO</td>
</tr>
</tbody>
</table>
<p>Example</p>
  <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"user_id"</span>: <span class="string">"U000334333"</span>,</span><br><span class="line">  <span class="attr">"wallet_id"</span>: <span class="string">"W00000001"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"alipay"</span>,</span><br><span class="line">  <span class="attr">"return_url"</span>: <span class="string">"https://merchantsite.com/checkout"</span>,</span><br><span class="line">  <span class="attr">"callback_url"</span>: <span class="string">"https://merchantsite.com/confirm"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"ip"</span>: <span class="string">"122.122.122.1"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"2.0"</span>,</span><br><span class="line">  <span class="attr">"product_name"</span>: <span class="string">"Pinot Noir, Otago"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"8d1bea078eaacdae8388852851ec39e2e8561cdce64f359421d85ed4844496ec"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>SHA-256 HMAC Signature</strong> <a href="https://jsfiddle.net/tonnyLTP/wj36tey4/45/" target="_blank" rel="noopener">Try your signature online</a></li>
</ul>
<p>Rearrange parameters alphabetically (except parameters with value of <code>null</code> or <code>empty</code> string) and join them with <code>&amp;</code>, and concat the value of <code>api_key</code> in the end.</p>
<p>JS code example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.keys(data)</span><br><span class="line">  .filter(<span class="function"><span class="params">item</span> =&gt;</span> data[item] != <span class="literal">null</span> &amp;&amp; data[item] != <span class="literal">undefined</span> &amp;&amp; data[item] !== <span class="string">''</span>)</span><br><span class="line">  .sort()</span><br><span class="line">  .map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;item&#125;</span>=<span class="subst">$&#123;data[item]&#125;</span>`</span>)</span><br><span class="line">  .join(<span class="string">'&amp;'</span>)</span><br><span class="line">  .concat(api_key)</span><br></pre></td></tr></table></figure>
<p>Example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message: amount=120.00&amp;callback_url=https://merchantsite.com/confirm&amp;ip=122.122.122.1&amp;merchant_reference=dsi39ej430sks03&amp;payment_method=alipay&amp;product_name=Pinot Noir, Otago&amp;return_url=https://merchantsite.com/checkout&amp;user_id=U000334333&amp;version=2.0&amp;wallet_id=W00000001111222333</span><br><span class="line">secret(your api_key): 111222333</span><br><span class="line"></span><br><span class="line">signature: 8d1bea078eaacdae8388852851ec39e2e8561cdce64f359421d85ed4844496ec</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Response</strong></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"host_url"</span>: <span class="string">"https://pay.latipay.net/pay"</span>,</span><br><span class="line">  <span class="attr">"nonce"</span>: <span class="string">"7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>host_url</td>
<td>String</td>
<td>A URL will direct customer to finish the payment.</td>
</tr>
<tr>
<td>nonce</td>
<td>String</td>
<td>The transaction nonce must be appended to the <code>host_url</code>.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
</tbody>
</table>
<p>Signature in Response</p>
<p class="tip">We are highly recommending you to verify the <strong>signature</strong> in merchant’s webserver to ensure the security.</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: nonce + host_url</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h3 id="STEP-2-Latipay-Payment-Interface"><a href="#STEP-2-Latipay-Payment-Interface" class="headerlink" title="STEP 2 - Latipay Payment Interface"></a>STEP 2 - Latipay Payment Interface</h3><p>Loading the URI in PC browser, mobile browser or Alipay/ WeChat’s embedded browser.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;host_url&#125;/&#123;nonce&#125;</span><br></pre></td></tr></table></figure></p>
<p class="tip">If it’s PC browser, you can load this url in current window or new window. But if it’s mobile browser or  inside of Alipay or Wechat, please load the url in this or similar way: <code>window.location.href={host_url}/{nonce}</code>, so the window will be redirected to payment gateway to finish the payment.</p>

<p>Example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pay.latipay.net/pay/7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3</span><br></pre></td></tr></table></figure>
<h3 id="STEP-3-Asynchronous-Notification"><a href="#STEP-3-Asynchronous-Notification" class="headerlink" title="STEP 3 - Asynchronous Notification"></a>STEP 3 - Asynchronous Notification</h3><p>Asynchronous Notification is a re-try mechanism to ensure the notification has been updated to the merchant’s web server. There is no times limitation until it returns an indicating <code>&quot;sent&quot;</code> text to Latipay. The time interval of this notification is about 30 seconds.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST merchant&apos;s callback_url</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br></pre></td></tr></table></figure>
<p class="tip">The status of response must be <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200" target="_blank" rel="noopener">200</a></p>

<p>Attributes</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A <code>unique id</code> identifying the order in Merchant’s system.</td>
<td>NO</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment methods can be <code>wechat</code>, <code>alipay</code> or <code>onlineBank</code>.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction can be <code>pending</code>, <code>paid</code>, or <code>failed</code>.</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>The payment time of the transaction processed. Latipay uses <code>UTC</code>as default timezone. <code>UTC/GMT+08:00</code></td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The <code>SHA-256 HMAC</code> API signature.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"currency"</span>: <span class="string">"NZD"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"alipay"</span>,</span><br><span class="line">  <span class="attr">"pay_time"</span>: <span class="string">"2017-07-07 10:53:50"</span>,</span><br><span class="line">  <span class="attr">"status"</span> : <span class="string">"paid"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"840151e0dc39496e22b410b83058b4ddd633b786936c505ae978fae029a1e0f1"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SHA-256 HMAC Signature<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure></p>
<p>Example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message: dsi39ej430sks03alipaypaidNZD120.00</span><br><span class="line">secret(your api_key): 111222333</span><br><span class="line"></span><br><span class="line">signature: 840151e0dc39496e22b410b83058b4ddd633b786936c505ae978fae029a1e0f1</span><br></pre></td></tr></table></figure>
<h3 id="STEP-4-Synchronous-Redirection"><a href="#STEP-4-Synchronous-Redirection" class="headerlink" title="STEP 4 - Synchronous Redirection"></a>STEP 4 - Synchronous Redirection</h3><p class="tip">This redirection only happens in Wechat pay’s embedded browser and OnlineBank. For Alipay, it only happens in PC browser, not in Alipay app.</p>

<p>There is a sync and front-end payment result redirection sent from Latipay to merchant after the payment is done successfully.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Redirect merchant&apos;s return_url</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A <code>unique id</code> identifying the order in Merchant’s system.</td>
<td>NO</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment methods can be <code>wechat</code>, <code>alipay</code> or <code>onlineBank</code>.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction can be <code>pending</code>, <code>paid</code>, or <code>failed</code>.</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The <code>SHA-256 HMAC</code> API signature.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.merchant.com/latipay?merchant_reference=dsi39ej430sks03&amp;payment_method=alipay&amp;status=paid&amp;currency=NZD&amp;amount=100.00&amp;signature= 14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3</span><br></pre></td></tr></table></figure>
<p>SHA-256 HMAC Signature</p>
<p>Merchant frontend need to validate the signature for protecting against malicious requests.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h3 id="STEP-5-Payment-Result-Interface"><a href="#STEP-5-Payment-Result-Interface" class="headerlink" title="STEP 5 - Payment Result Interface"></a>STEP 5 - Payment Result Interface</h3><p>All customers can send requests to query payment status with merchant order id(that should be <code>unique id</code> for the merchant) as merchant_reference by HTTP GET request.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://api.latipay.net/v2/transaction/&#123;merchant_reference&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>The user account you want to use to process the transaction.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The <code>SHA-256 HMAC</code> API signature.</td>
</tr>
<tr>
<td>is_block</td>
<td>Number</td>
<td>Optional parameter, <code>1</code> means the http request use long poolling mechanism, the timeout is 180s.</td>
</tr>
</tbody>
</table>
<h4 id="SHA-256-HMAC-Signature"><a href="#SHA-256-HMAC-Signature" class="headerlink" title="SHA-256 HMAC Signature"></a>SHA-256 HMAC Signature</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + user_id</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://api.latipay.net/v2/transaction/1289323A122DB?user_id=U000334333&amp;signature=14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3</span><br></pre></td></tr></table></figure>
<h4 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A <code>unique id</code> identifying the order in Merchant’s system.</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment method used. Possible values are alipay and wechat.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction. Possible values are: pending, paid, or failed.</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>Show the payment time of the transaction order. <code>UTC/GMT+08:00</code></td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The <code>SHA-256 HMAC</code> API signature.</td>
</tr>
</tbody>
</table>
<h4 id="Example-Response"><a href="#Example-Response" class="headerlink" title="Example Response"></a>Example Response</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"currency"</span>: <span class="string">"AUD"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"wechat"</span>,</span><br><span class="line">  <span class="attr">"status"</span>: <span class="string">"paid"</span>,</span><br><span class="line">  <span class="attr">"pay_time"</span>: <span class="string">"2017-07-07 10:53:50"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Signature-in-Response"><a href="#Signature-in-Response" class="headerlink" title="Signature in Response"></a>Signature in Response</h4><p>For security reasons, we highly recommend you verify the signature in the response.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Example-Signature"><a href="#Example-Signature" class="headerlink" title="Example Signature"></a>Example Signature</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message: dsi39ej430sks03alipaypaidNZD120.00</span><br><span class="line">secret(your api_key): 111222333</span><br><span class="line"></span><br><span class="line">signature: 840151e0dc39496e22b410b83058b4ddd633b786936c505ae978fae029a1e0f1</span><br></pre></td></tr></table></figure>

  
    <div class="guide-links">
      
        <span>← <a href="/v2/index.html">Introduction</a></span>
      
      
        <span style="float: right;"><a href="/v2/merchant-hosted-offline.html">Merchant Hosted Offline/Hardware</a> →</span>
      
    </div>
  
  <div class="footer">
  </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>


    <!-- fastclick -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
    </script>
  </body>
</html>
