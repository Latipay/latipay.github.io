

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Latipay Hosted - In-Store</title>
    <meta charset="utf-8">
    <meta name="description" content="Latipay">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Latipay Hosted - In-Store">
    <meta property="og:description" content="Latipay">
    <meta property="og:image" content="https://latipay.net//images/logo.png">

    <link rel="icon" href="https://merchant.latipay.net/favicon.ico">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <script>window.PAGE_TYPE = "v2"</script>

  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.svg">
  </a>

  <ul id="nav">
    <li>
  	  <a href="/v2_cn/index.html" class="nav-link">中文</a>
  	</li>
    
	  <li>
	    <a href="/v2/index.html" class="nav-link">English</a>
	  </li>
  </ul>
</div>
    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <div class="list">
      <h2>
        V2
      </h2>
      <ul class="menu-root">
  
    <li>
      <a href="/v2/index.html" class="sidebar-link">Introduction</a>
    </li>
  
    <li>
      <a href="/v2/latipay-hosted-online.html" class="sidebar-link">Latipay Hosted - Online</a>
    </li>
  
    <li>
      <a href="/v2/latipay-hosted-in-store.html" class="sidebar-link current">Latipay Hosted - In-Store</a>
    </li>
  
    <li>
      <a href="/v2/merchant-hosted-online.html" class="sidebar-link">Merchant Hosted - Online</a>
    </li>
  
    <li>
      <a href="/v2/error-code.html" class="sidebar-link">Error Code</a>
    </li>
  
</ul>

    </div>
  </div>
</div>


<div class="content v2 with-sidebar ">
  
    
      
    
  
  
    <h1>Latipay Hosted - In-Store</h1>
  
  <p><a href="/pdf/latipay-hosted-in-store.pdf">Download PDF</a></p>
<p>Welcome! It looks like you’re ready to connect with Latipay. This reference documentation explains how it can be done using Latipay’s API. Once setup, you’ll be tapping into millions of Chinese consumers who prefer local payment methods. We’re constantly updating our payment methods but would love to hear your suggestions on how we could improve our platform.</p>
<p class="tip">This document is only suitable for the following <code>in-store</code> situation.</p>

<ul>
<li>Customer scans <code>Alipay payment QR code</code> through <code>Alipay app</code>.</li>
<li>Customer scans <code>Wechat payment QR code</code> through <code>Wechat app</code>.</li>
</ul>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>The Latipay 2.0 interface is an independent Hosted Payments Page (HPP) solution provided by Latipay. The HPP provides a solution for capturing Wechat/ Alipay and 19 main Chinese banks information securely without exposing the merchant to sensitive financial data. The Latipay Hosted Ecommerce API provides merchants with a secure and versatile solution for <code>in-store</code> payments <a href="#Transaction-Interface">(Transaction-Interface)</a>. Redirecting users to a Latipay Hosted Payment Page to complete the payment <a href="#Payment-Interface">(Payment-Interface)</a>. A real-time confirmation <a href="#Synchronous-Redirection">redirection</a> of payment from Latipay will be displayed on the merchant’s website. At the same time, a <a href="#Payment-Result-Asynchronous-Notification">notification</a> will be implemented to the merchant to ensure that confirmation of payments have been sent to an allocated callback_url in less than 30s. Merchants also can track payment status through the <a href="#Query-Interface">Latipay Order Query API</a>.</p>
<h2 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works?"></a>How it works?</h2><p><img src="http://latipay.net/wp-content/uploads/images/01_-_Online_payment_workflow_-_Latipay_hosted-_both-02.png" alt=""></p>
<ol>
<li><p>To process a transaction, customers select <code>Alipay</code>, <code>Wechat</code> as <strong>in-store</strong> payment method in merchant’s website, e.g. in E-commerce website.</p>
</li>
<li><p>the <strong>merchant</strong>’s ecommerce server sends a transaction request <a href="#Transaction-Interface">#Transaction-Interface</a> to <strong>Latipay</strong> with the authentication and order details.</p>
</li>
<li><p><strong>Latipay</strong> responds with a <code>host_url</code> and <code>nonce</code>.</p>
</li>
<li><p>The <strong>merchant</strong>‘s server redirect the website to the host_url with nonce as parameter.<a href="#Payment-Interface">#Payment-Interface</a></p>
</li>
<li><p>The customer will be prompted to a page which requires him/she to <code>scan the QR code</code> with Alipay or Wechat app and complete the transaction.</p>
</li>
<li><p>The result of payment is displayed in <strong>merchant</strong>’s website or <strong>merchant’s</strong> terminal/device in-store.</p>
</li>
</ol>
<h2 id="Payment-Scenarios"><a href="#Payment-Scenarios" class="headerlink" title="Payment Scenarios"></a>Payment Scenarios</h2><h4 id="Alipay"><a href="#Alipay" class="headerlink" title="Alipay"></a>Alipay</h4><p><img src="http://latipay.net/wp-content/uploads/images/Alipay_MerchantHosted.png" alt=""></p>
<hr>
<h4 id="WeChat-Pay"><a href="#WeChat-Pay" class="headerlink" title="WeChat Pay"></a>WeChat Pay</h4><p><img src="http://latipay.net/wp-content/uploads/images/Wechat-latipayhosted.png" alt=""></p>
<h2 id="API-List"><a href="#API-List" class="headerlink" title="API List"></a>API List</h2><h3 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h3><p>Before using bellowing api, please make sure you have <code>user_id</code>, <code>wallet_id</code> and <code>api_key</code> on hand. If you don’t have them, we would like to help you. <a href="http://www.latipay.net/contact/" target="_blank" rel="noopener">Contact Us</a>. </p>
<h3 id="Transaction-Interface"><a href="#Transaction-Interface" class="headerlink" title="Transaction Interface"></a>Transaction Interface</h3><p>Create a latipay transaction(or order) is the first step for using alipay or wechat pay.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST https://api.latipay.net/v2/transaction</span><br></pre></td></tr></table></figure>
<h4 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>The user account you want to use to process the transaction.</td>
<td>No</td>
</tr>
<tr>
<td>wallet_id</td>
<td>String</td>
<td>The ID of the wallet you want to use.</td>
<td>No</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>Payment method options are wechat, alipay.</td>
<td>No</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
<td>No</td>
</tr>
<tr>
<td>return_url</td>
<td>String</td>
<td>The URL of the landing page where Latipay will return the customer after payment.</td>
<td>No</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>The URL of the callback address the transaction notification is sent after payment.</td>
<td>No</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
<td>No</td>
</tr>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A field for identifying your transaction.</td>
<td>No</td>
</tr>
<tr>
<td>ip</td>
<td>String</td>
<td>The IP address of the customer.</td>
<td>No</td>
</tr>
<tr>
<td>version</td>
<td>String</td>
<td>The latest version of the platform.</td>
<td>No</td>
</tr>
<tr>
<td>product_name</td>
<td>String</td>
<td>The name of the product or service being sold.</td>
<td>No</td>
</tr>
</tbody>
</table>
<h4 id="Example-Parameters"><a href="#Example-Parameters" class="headerlink" title="Example Parameters"></a>Example Parameters</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"user_id"</span>: <span class="string">"U000334333"</span>,</span><br><span class="line">  <span class="attr">"wallet_id"</span>: <span class="string">"W00000001"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"alipay"</span>,</span><br><span class="line">  <span class="attr">"return_url"</span>: <span class="string">"https://merchantsite.com/checkout"</span>,</span><br><span class="line">  <span class="attr">"callback_url"</span>: <span class="string">"https://merchantsite.com/confirm"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"ip"</span>: <span class="string">"122.122.122.1"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"2.0"</span>,</span><br><span class="line">  <span class="attr">"product_name"</span>: <span class="string">"Pinot Noir, Otago"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SHA-256-HMAC-Signature"><a href="#SHA-256-HMAC-Signature" class="headerlink" title="SHA-256 HMAC Signature"></a>SHA-256 HMAC Signature</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: user_id + wallet_id + amount + payment_method + return_url + callback_url</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Example-Signature"><a href="#Example-Signature" class="headerlink" title="Example Signature"></a>Example Signature</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">message: U000000001W000000010.01alipayhttp://merchant.com/returnhttp://merchant.com/callback</span><br><span class="line">secret: 111222333</span><br><span class="line">signature: 2367bcd9e9a2f9a547c85d7545d1217702a574b8084bbb7ae33b45a03a89983</span><br></pre></td></tr></table></figure>
<h4 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"host_url"</span>: <span class="string">"https://pay.latipay.net/pay"</span>,</span><br><span class="line">  <span class="attr">"nonce"</span>: <span class="string">"7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>host_url</td>
<td>String</td>
<td>The host URL to send your customer.</td>
</tr>
<tr>
<td>nonce</td>
<td>String</td>
<td>The transaction nonce must be appended to the <em>host_url</em> when redirecting the customer.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
</tbody>
</table>
<h4 id="Signature-in-Response"><a href="#Signature-in-Response" class="headerlink" title="Signature in Response"></a>Signature in Response</h4><p>For security reasons, we highly recommend you verify the signature in the response.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: nonce + host_url</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Extra-Parameters-for-alipay-and-wechat"><a href="#Extra-Parameters-for-alipay-and-wechat" class="headerlink" title="Extra Parameters for alipay and wechat"></a>Extra Parameters for alipay and wechat</h4><p>Please check out the response of <a href="#Payment-Interface">#Payment-Interface</a></p>
<p></p><p class="tip">When load the url <code>{host_url}/{nonce}</code> in next step <a href="#Payment-Interface">#Payment Interface</a>, you will get different result depend on the environment and extra parameter.</p><p></p>
<h3 id="Payment-Interface"><a href="#Payment-Interface" class="headerlink" title="Payment Interface"></a>Payment Interface</h3><p>Load bellowing url in browser or send GET request</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;host_url&#125;/&#123;nonce&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pay.latipay.net/pay/7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3</span><br></pre></td></tr></table></figure>
<h4 id="Response-based-on-Environment-and-Extra-Parameters"><a href="#Response-based-on-Environment-and-Extra-Parameters" class="headerlink" title="Response, based on Environment and Extra Parameters"></a>Response, based on Environment and Extra Parameters</h4><table>
<thead>
<tr>
<th>Environment</th>
<th>Payment Method</th>
<th>Extra Parameters for <a href="#Transaction-Interface">#Transaction-Interface</a></th>
<th>Response</th>
<th>Customer makes payment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Alipay inner browser</td>
<td>alipay</td>
<td>is_staticpay=”1”</td>
<td>Alipay app pay directly</td>
<td><img src="../images/alipay.png?a" alt=""></td>
</tr>
<tr>
<td>Mobile browser</td>
<td>alipay</td>
<td>is_staticpay=”1”</td>
<td>Mobile browser try to launch Alipay app</td>
<td><img src="../images/alipay-mobile-browser.png?a" alt=""></td>
</tr>
<tr>
<td>PC browser/Mobile browser</td>
<td>alipay</td>
<td>present_qr=”1” is_spotpay=”1”</td>
<td>a Latipay webpage which presents QR code which waiting for Alipay app to scan</td>
<td><img src="../images/alipay-latipay.png?a" alt=""></td>
</tr>
<tr>
<td>Any</td>
<td>alipay</td>
<td>is_spotpay=”1”</td>
<td>a json contains <code>qr_code</code> text</td>
<td>Merchant backend or frontend needs to generate QR Code and display it to customer</td>
</tr>
<tr>
<td>Non Wechat App</td>
<td>wechat</td>
<td>present_qr=”1”</td>
<td>a Latipay webpage which presents QR code which waiting for Wechat app to scan</td>
<td><img src="../images/wechat-latipay.png?b" alt=""></td>
</tr>
<tr>
<td>Non-Wechat App</td>
<td>wechat</td>
<td></td>
<td>a json contains <code>code_url</code> text</td>
<td>Merchant backend or frontend needs to generate QR Code and display it to customer</td>
</tr>
</tbody>
</table>
<p>Alipay QR Code text</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"qr_code"</span>: <span class="string">"https://qr.alipay.com/bax081077lt4kxtaupg00082"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Wechat QR Code text</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"code_url"</span>:<span class="string">"weixin://wxpay/bizpayurl?pr=12121312"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Payment-Result-Asynchronous-Notification"><a href="#Payment-Result-Asynchronous-Notification" class="headerlink" title="Payment Result Asynchronous Notification"></a>Payment Result Asynchronous Notification</h3><p>There is an asynchronous and back-end payment result notification sent by Latipay to merchant after the payment is done successfully. There is a re-try mechanism with the notification to ensure the notification could be delivered to the merchant. If you receive callback notification, please send “sent” to us. Callback notification can be sent many times until we receive “sent”.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST merchant&apos;s callback_url</span><br></pre></td></tr></table></figure>
<h4 id="Parameters-1"><a href="#Parameters-1" class="headerlink" title="Parameters"></a>Parameters</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
<tr>
<td>transaction_id</td>
<td>String</td>
<td>f66f-4f1b-9ef5-43cb917ff8a6 (string) - A unique transaction identifier generated by Latipay.</td>
</tr>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A field for identifying your transaction.</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment method used. Possible values are wechat, alipay.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction. Possible values are: pending, paid, or failed.</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>Show the payment time of the transaction order.</td>
</tr>
</tbody>
</table>
<h4 id="Example-Parameters-1"><a href="#Example-Parameters-1" class="headerlink" title="Example Parameters"></a>Example Parameters</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"transaction_id"</span>: <span class="string">"43cb917ff8a6"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"currency"</span>: <span class="string">"NZD"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"alipay"</span>,</span><br><span class="line">  <span class="attr">"pay_time"</span>: <span class="string">"2017-07-07 10:53:50"</span>,</span><br><span class="line">  <span class="attr">"status"</span> : <span class="string">"paid"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SHA-256-HMAC-Signature-1"><a href="#SHA-256-HMAC-Signature-1" class="headerlink" title="SHA-256 HMAC Signature"></a>SHA-256 HMAC Signature</h4><p>Merchant backend need to validate the signature for protecting against malicious requests.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Expected-text-“sent”-in-Response’s-body"><a href="#Expected-text-“sent”-in-Response’s-body" class="headerlink" title="Expected text “sent” in Response’s body"></a>Expected text “sent” in Response’s body</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sent</span><br></pre></td></tr></table></figure>
<h3 id="Synchronous-Redirection"><a href="#Synchronous-Redirection" class="headerlink" title="Synchronous Redirection"></a>Synchronous Redirection</h3><p>There is a sync and front-end payment result redirection sent by Latipay to merchant after the payment is done successfully.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Redirect merchant&apos;s return_url</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A field for identifying your transaction.</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment method used. Possible values are wechat, alipay.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction. Possible values are: pending, paid, or failed.</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
</tbody>
</table>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.merchant.com/latipay?merchant_reference=dsi39ej430sks03&amp;payment_method=alipay&amp;status=paid&amp;currency=NZD&amp;amount=100.00&amp;signature= 14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3</span><br></pre></td></tr></table></figure>
<h4 id="SHA-256-HMAC-Signature-2"><a href="#SHA-256-HMAC-Signature-2" class="headerlink" title="SHA-256 HMAC Signature"></a>SHA-256 HMAC Signature</h4><p>Merchant frontend need to validate the signature for protecting against malicious requests.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h3 id="Query-Interface"><a href="#Query-Interface" class="headerlink" title="Query Interface"></a>Query Interface</h3><p>All customers can send request to search their transaction order by merchant order id(that should be unique id for the merchant) as merchant_reference by HTTP GET request.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://api.latipay.net/v2/transaction/&#123;merchant_reference&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Parameters-2"><a href="#Parameters-2" class="headerlink" title="Parameters"></a>Parameters</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>The user account you want to use to process the transaction.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
</tbody>
</table>
<h4 id="SHA-256-HMAC-Signature-3"><a href="#SHA-256-HMAC-Signature-3" class="headerlink" title="SHA-256 HMAC Signature"></a>SHA-256 HMAC Signature</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + user_id</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
<h4 id="Response-1"><a href="#Response-1" class="headerlink" title="Response"></a>Response</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>signature</td>
<td>String</td>
<td>The SHA-256 HMAC API signature.</td>
</tr>
<tr>
<td>transaction_id</td>
<td>String</td>
<td>A unique transaction identifier generated by Latipay.</td>
</tr>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>A field for identifying your transaction.</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>The currency code of the transaction.</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>A decimal amount.</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>The payment method used. Possible values are wechat, alipay.</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>The status of the transaction. Possible values are: pending, paid, or failed.</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>Show the payment time of the transaction order.</td>
</tr>
</tbody>
</table>
<h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">  <span class="attr">"transaction_id"</span>: <span class="string">"20170707-wechat-3473511594933"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"currency"</span>: <span class="string">"AUD"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"wechat"</span>,</span><br><span class="line">  <span class="attr">"status"</span>: <span class="string">"paid"</span>,</span><br><span class="line">  <span class="attr">"pay_time"</span>: <span class="string">"2017-07-07 10:53:50"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Signature-in-Response-1"><a href="#Signature-in-Response-1" class="headerlink" title="Signature in Response"></a>Signature in Response</h4><p>For security reasons, we highly recommend you verify the signature in the response.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">secret: api_key</span><br></pre></td></tr></table></figure>
  
    <div class="guide-links">
      
        <span>← <a href="/v2/latipay-hosted-online.html">Latipay Hosted - Online</a></span>
      
      
        <span style="float: right;"><a href="/v2/merchant-hosted-online.html">Merchant Hosted - Online</a> →</span>
      
    </div>
  
  <div class="footer">
  </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>


    <!-- fastclick -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
    </script>
  </body>
</html>
