

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Latipay Hosted</title>
    <meta charset="utf-8">
    <meta name="description" content="Latipay">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Latipay Hosted">
    <meta property="og:description" content="Latipay">
    <meta property="og:image" content="https://latipay.net//images/logo.png">

    <link rel="icon" href="https://merchant.latipay.net/favicon.ico">

    <meta name="msapplication-TileColor" content="#4fc08d">
    <meta name="theme-color" content="#4fc08d">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <script>window.PAGE_TYPE = "v2_cn"</script>

  </head>
  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.svg">
  </a>

  <ul id="nav">
    <!-- <li>
  	  <a href="/api-console/index.html" class="nav-link">API Console</a>
  	</li> -->

    <li>
  	  <a href="/v2_cn/index.html" class="nav-link">中文</a>
  	</li>

	  <li>
	    <a href="/v2/index.html" class="nav-link">English</a>
	  </li>
  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <div class="list">
      <h2>
        V2_cn
      </h2>
      <ul class="menu-root">
  
    <li>
      <a href="/v2_cn/index.html" class="sidebar-link current">Latipay Hosted</a>
    </li>
  
    <li>
      <a href="/v2_cn/merchant-hosted-offline.html" class="sidebar-link">Merchant Hosted Offline/Hardware</a>
    </li>
  
</ul>

    </div>
  </div>
</div>


<div class="content v2_cn with-sidebar ">
  
    
      
    
  
  
    <h1>Latipay Hosted</h1>
  
  <p><a href="http://doc.latipay.net/api-console/online.html" target="_blank" rel="noopener">在线测试API</a></p>
<p class="tip">1. 集成Latipay API需要提前准备好Wallet ID, User ID 和 API key。 <a href="https://merchant.latipay.net/account" target="__blank">Latipay Merchant Portal</a> &gt; Account &gt; Show hidden values；<br>2. 对应的Wallet ID需要事先开通alipay，wechat或者onlineBank权限；<br>3. 请勿泄漏api_key；<br>4. 测试时可以支付最小金额$0.01。</p>

<h2 id="支持的支付方式"><a href="#支持的支付方式" class="headerlink" title="支持的支付方式"></a>支持的支付方式</h2><ul>
<li>支付宝</li>
<li>微信支付</li>
<li>人民币银行（16家）</li>
</ul>
<h2 id="支付流程图"><a href="#支付流程图" class="headerlink" title="支付流程图"></a>支付流程图</h2><p>支付宝</p>
<p><img src="../images/Merchant Hosted Online Alipay.jpeg" alt=""></p>
<hr>
<p>微信<br><img src="../images/latipay_hosted_online.jpg" alt=""></p>
<hr>
<p>人民币银行卡</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="../images/Merchant Hosted Online Bank.jpeg" alt=""></h2><h2 id="支付场景"><a href="#支付场景" class="headerlink" title="支付场景"></a>支付场景</h2><h4 id="支付宝"><a href="#支付宝" class="headerlink" title="支付宝"></a>支付宝</h4><p><img src="http://latipay.net/wp-content/uploads/images/Alipay-latipayhosted.png" alt=""></p>
<hr>
<h4 id="微信"><a href="#微信" class="headerlink" title="微信"></a>微信</h4><p><img src="http://latipay.net/wp-content/uploads/images/Wechat-latipayhosted.png" alt=""></p>
<hr>
<h4 id="在线银行"><a href="#在线银行" class="headerlink" title="在线银行"></a>在线银行</h4><p><img src="http://latipay.net/wp-content/uploads/images/Onlinebank-latipayhosted.png" alt=""></p>
<hr>
<h4 id="电商网站"><a href="#电商网站" class="headerlink" title="电商网站"></a>电商网站</h4><p><img src="http://latipay.net/wp-content/uploads/images/checkout_show.png" alt=""></p>
<h2 id="接口列表"><a href="#接口列表" class="headerlink" title="接口列表"></a>接口列表</h2><h3 id="1-下单"><a href="#1-下单" class="headerlink" title="1. 下单"></a>1. 下单</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST https://api.latipay.net/v2/transaction</span><br><span class="line">Content-Type: application/json;charset=UTF-8</span><br></pre></td></tr></table></figure>
<p><a href="http://doc.latipay.net/api-console/online.html?api=/v2/transaction" target="_blank" rel="noopener">在线测试API</a></p>
<p>Demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl \</span><br><span class="line">-X POST \</span><br><span class="line">-H &quot;Content-Type: application/json;charset=UTF-8&quot; \</span><br><span class="line">-d &apos;&#123;&quot;user_id&quot;:&quot;U000334333&quot;,&quot;wallet_id&quot;:&quot;W00000001&quot;,&quot;amount&quot;:&quot;120.00&quot;,&quot;payment_method&quot;:&quot;alipay&quot;,&quot;return_url&quot;:&quot;https://merchantsite.com/checkout&quot;,&quot;callback_url&quot;:&quot;https://merchantsite.com/confirm&quot;,&quot;signature&quot;:&quot;14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3&quot;,&quot;merchant_reference&quot;:&quot;dsi39ej430sks03&quot;,&quot;ip&quot;:&quot;122.122.122.1&quot;,&quot;version&quot;:&quot;2.0&quot;,&quot;product_name&quot;:&quot;Pinot Noir, Otago&quot;&#125;&apos; \</span><br><span class="line">https://api.latipay.net/v2/transaction</span><br></pre></td></tr></table></figure>
<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
<th>可选</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>商户账号用户 id</td>
<td>No</td>
</tr>
<tr>
<td>wallet_id</td>
<td>String</td>
<td>商户账号wallet id</td>
<td>No</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>支付方式 <code>wechat</code>, <code>alipay</code>, <code>onlineBank</code>, or <code>unionpay</code></td>
<td>No</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>支付金额</td>
<td>No</td>
</tr>
<tr>
<td>return_url</td>
<td>String</td>
<td>支付完成后浏览器继续加载的地址</td>
<td>No</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>支付完成后异步通知地址</td>
<td>No</td>
</tr>
<tr>
<td>backPage_url</td>
<td>String</td>
<td>如果有此参数，支付页面上会显示该链接：“&lt;取消订单并返回”，顾客点击该链接，返回商户网站</td>
<td>YES</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>参数签名，算法为SHA-256 HMAC</td>
<td>No</td>
</tr>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>商户订单号</td>
<td>No</td>
</tr>
<tr>
<td>ip</td>
<td>String</td>
<td>客户端ip</td>
<td>No</td>
</tr>
<tr>
<td>version</td>
<td>String</td>
<td>版本号 <code>&quot;2.0&quot;</code></td>
<td>No</td>
</tr>
<tr>
<td>product_name</td>
<td>String</td>
<td>订单产品标题</td>
<td>No</td>
</tr>
</tbody>
</table>
<h4 id="微信的额外参数"><a href="#微信的额外参数" class="headerlink" title="微信的额外参数"></a>微信的额外参数</h4><table>
<thead>
<tr>
<th>参数</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>present_qr = “1”</td>
<td>使用该参数可以获取一个支持微信扫码支付的网页</td>
</tr>
</tbody>
</table>
<h4 id="参数例子"><a href="#参数例子" class="headerlink" title="参数例子"></a>参数例子</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"user_id"</span>: <span class="string">"U000334333"</span>,</span><br><span class="line">  <span class="attr">"wallet_id"</span>: <span class="string">"W00000001"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="string">"120.00"</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"alipay"</span>,</span><br><span class="line">  <span class="attr">"return_url"</span>: <span class="string">"https://merchantsite.com/checkout"</span>,</span><br><span class="line">  <span class="attr">"callback_url"</span>: <span class="string">"https://merchantsite.com/confirm"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"ip"</span>: <span class="string">"122.122.122.1"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"2.0"</span>,</span><br><span class="line">  <span class="attr">"product_name"</span>: <span class="string">"Pinot Noir, Otago"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="参数-SHA-256-HMAC-签名"><a href="#参数-SHA-256-HMAC-签名" class="headerlink" title="参数 SHA-256 HMAC 签名"></a>参数 SHA-256 HMAC 签名</h4><p>将所有参数按字母表顺序从小到大排序（去掉其中值为null和空字符串的项），然后以key=value和&amp;形式拼接，最后加上api_key</p>
<p>JS代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.keys(data)</span><br><span class="line">  .filter(item =&gt; data[item] != null &amp;&amp; data[item] != undefined &amp;&amp; data[item] !== &apos;&apos;)</span><br><span class="line">  .sort()</span><br><span class="line">  .map(item =&gt; `$&#123;item&#125;=$&#123;data[item]&#125;`)</span><br><span class="line">  .join(&apos;&amp;&apos;)</span><br><span class="line">  .concat(api_key)</span><br></pre></td></tr></table></figure></p>
<h4 id="签名例子"><a href="#签名例子" class="headerlink" title="签名例子"></a>签名例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">待签名文本: amount=120.00&amp;callback_url=https://merchantsite.com/confirm&amp;ip=122.122.122.1&amp;merchant_reference=dsi39ej430sks03&amp;payment_method=alipay&amp;product_name=Pinot Noir, Otago&amp;return_url=https://merchantsite.com/checkout&amp;user_id=U000334333&amp;version=2.0&amp;wallet_id=W00000001111222333</span><br><span class="line">密钥: 111222333</span><br><span class="line"></span><br><span class="line">签名结果: 8d1bea078eaacdae8388852851ec39e2e8561cdce64f359421d85ed4844496ec</span><br></pre></td></tr></table></figure>
<h4 id="请求结果"><a href="#请求结果" class="headerlink" title="请求结果"></a>请求结果</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"code"</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"message"</span>: <span class="string">"SUCCESS"</span>,</span><br><span class="line">  <span class="attr">"host_url"</span>: <span class="string">"https://pay.latipay.net/pay"</span>,</span><br><span class="line">  <span class="attr">"nonce"</span>: <span class="string">"7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3"</span>,</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>Int</td>
<td>0 代表成功</td>
</tr>
<tr>
<td>host_url</td>
<td>String</td>
<td>供浏览器加载的url，使用url和nonce可以完成下一步支付</td>
</tr>
<tr>
<td>nonce</td>
<td>String</td>
<td>订单的临时编号。每次付款都应该调用本接口来保证nonce是最新的，永远不要存储此nonce</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>服务器端签名，算法为SHA-256 HMAC</td>
</tr>
</tbody>
</table>
<h4 id="signature-服务器端签名"><a href="#signature-服务器端签名" class="headerlink" title="signature 服务器端签名"></a>signature 服务器端签名</h4><p>服务器端返回结果前，会对nonce + host_url加密，商户端需要进行验证，以保证该请求的合法性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">待签名文本: nonce + host_url</span><br><span class="line">密钥: api_key</span><br></pre></td></tr></table></figure>
<h3 id="2-支付"><a href="#2-支付" class="headerlink" title="2. 支付"></a>2. 支付</h3><p>加载以下地址继续支付订单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;host_url&#125;/&#123;nonce&#125;</span><br></pre></td></tr></table></figure>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pay.latipay.net/pay/7d5a88119354301ad3fc250404493bd27abf4467283a061d1ed11860a46e1bf3</span><br></pre></td></tr></table></figure>
<h4 id="不同参数，不同平台下支付方式会有差别"><a href="#不同参数，不同平台下支付方式会有差别" class="headerlink" title="不同参数，不同平台下支付方式会有差别"></a>不同参数，不同平台下支付方式会有差别</h4><table>
<thead>
<tr>
<th>场景</th>
<th>支付方式</th>
<th>额外参数</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>PC浏览器</td>
<td>alipay</td>
<td></td>
<td>跳转到支付宝二维码收银台网页</td>
</tr>
<tr>
<td>手机浏览器</td>
<td>alipay</td>
<td></td>
<td>唤醒支付宝app完成支付</td>
</tr>
<tr>
<td>支付宝内浏览器</td>
<td>alipay</td>
<td></td>
<td>支付宝app直接支付</td>
</tr>
<tr>
<td>微信内浏览器</td>
<td>wechat</td>
<td></td>
<td>微信支付</td>
</tr>
<tr>
<td></td>
<td>wechat</td>
<td>present_qr = “1”</td>
<td>跳转到一个支持微信扫码支付的网页</td>
</tr>
<tr>
<td></td>
<td>onlineBank</td>
<td></td>
<td>跳转到一个支持输入银行卡信息的网页</td>
</tr>
</tbody>
</table>
<h3 id="3-支付结果异步通知"><a href="#3-支付结果异步通知" class="headerlink" title="3. 支付结果异步通知"></a>3. 支付结果异步通知</h3><p>此接口为商户端后台提供，在支付完成后，Latipay服务器每隔30秒调用该接口，直到收到<code>sent</code>文本，在调用该接口时，Latipay会传入支付结果信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST 商户端的 callback_url</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br></pre></td></tr></table></figure>
<p class="tip">返回的请求头状态必须为 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200" target="_blank" rel="noopener">200</a>，请求的body必须是文本：<code>sent</code></p>


<h4 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h4><table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>商户订单id</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>Latipay交易id</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>支付币种</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>支付金额</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>支付方式</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>支付状态，值可能为: pending, paid, 或 failed.</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>支付时间，北京时间 <code>UTC/GMT+08:00</code></td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>参数签名，算法为SHA-256 HMAC</td>
</tr>
</tbody>
</table>
<h4 id="参数例子-1"><a href="#参数例子-1" class="headerlink" title="参数例子"></a>参数例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">merchant_reference=dsi39ej430sks03&amp;order_id=2017232323345678&amp;amount=120.00&amp;currency=NZD&amp;payment_method=alipay&amp;pay_time=2017-07-07%2010%3A53%3A50&amp;status=paid&amp;signature=840151e0dc39496e22b410b83058b4ddd633b786936c505ae978fae029a1e0f1</span><br></pre></td></tr></table></figure>
<h4 id="SHA-256-HMAC签名"><a href="#SHA-256-HMAC签名" class="headerlink" title="SHA-256 HMAC签名"></a>SHA-256 HMAC签名</h4><p>商户端后台需要验证该签名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">待签名文本: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">密钥: api_key</span><br></pre></td></tr></table></figure>
<h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p>Latipay服务器期望收到此文本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sent</span><br></pre></td></tr></table></figure>
<h3 id="4-支付完成后（成功或失败）浏览器重定向"><a href="#4-支付完成后（成功或失败）浏览器重定向" class="headerlink" title="4. 支付完成后（成功或失败）浏览器重定向"></a>4. 支付完成后（成功或失败）浏览器重定向</h3><p class="tip">此功能仅支持PC浏览器或者微信支付。支付宝App扫码支付成功后，支付宝App并不会跳转。此接口被调用并不意味着支付就成功，安全起见，您需要再通过服务器查询Latipay的订单状态。</p>

<p>客户端支付完成后，会跳转到return_url，并传入以下参数</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>商户订单id</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>支付方式，可能值：alipay, wechat, onlineBank</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>支付状态，可能值: pending, paid, 或 failed</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>支付币种</td>
</tr>
<tr>
<td>amount</td>
<td>String</td>
<td>支付金额</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>服务器端签名，算法为SHA-256 HMAC</td>
</tr>
</tbody>
</table>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.merchant.com/latipay?merchant_reference=dsi39ej430sks03&amp;payment_method=alipay&amp;status=paid&amp;currency=NZD&amp;amount=100.00&amp;signature=14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3</span><br></pre></td></tr></table></figure>
<h4 id="服务器端-SHA-256-HMAC-签名"><a href="#服务器端-SHA-256-HMAC-签名" class="headerlink" title="服务器端 SHA-256 HMAC 签名"></a>服务器端 SHA-256 HMAC 签名</h4><p>商户端前端可以考虑验证该签名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">待签名文本: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">密钥: api_key</span><br></pre></td></tr></table></figure>
<h3 id="5-查询支付"><a href="#5-查询支付" class="headerlink" title="5. 查询支付"></a>5. 查询支付</h3><p>向Latipay服务器查询订单支付信息，merchant_reference为商户端订单id。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://api.latipay.net/v2/transaction/&#123;merchant_reference&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://doc.latipay.net/api-console/online.html?api=/v2/transaction/{merchant_reference}" target="_blank" rel="noopener">在线测试API</a></p>
<h4 id="参数-2"><a href="#参数-2" class="headerlink" title="参数"></a>参数</h4><table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>String</td>
<td>商户账号用户 id</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>参数签名，算法为SHA-256 HMAC</td>
</tr>
</tbody>
</table>
<h4 id="SHA-256-HMAC-签名"><a href="#SHA-256-HMAC-签名" class="headerlink" title="SHA-256 HMAC 签名"></a>SHA-256 HMAC 签名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">待签名文本: merchant_reference + user_id</span><br><span class="line">密钥: api_key</span><br></pre></td></tr></table></figure>
<h4 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h4><table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>merchant_reference</td>
<td>String</td>
<td>商户订单id</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>支付币种</td>
</tr>
<tr>
<td>amount</td>
<td>Number</td>
<td>支付金额</td>
</tr>
<tr>
<td>payment_method</td>
<td>String</td>
<td>支付方式，可能值：alipay, wechat, onlineBank</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>支付状态，可能值: pending, paid, 或 failed</td>
</tr>
<tr>
<td>pay_time</td>
<td>String</td>
<td>支付时间，北京时间 <code>UTC/GMT+08:00</code></td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>Latiapy系统内的唯一支付单号</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>服务器端签名，算法为SHA-256 HMAC</td>
</tr>
</tbody>
</table>
<h4 id="参数例子-2"><a href="#参数例子-2" class="headerlink" title="参数例子"></a>参数例子</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"signature"</span>: <span class="string">"14d5b06a2a5a2ec509a148277ed4cbeb3c43301b239f080a3467ff0aba4070e3"</span>,</span><br><span class="line">  <span class="attr">"merchant_reference"</span>: <span class="string">"dsi39ej430sks03"</span>,</span><br><span class="line">  <span class="attr">"currency"</span>: <span class="string">"AUD"</span>,</span><br><span class="line">  <span class="attr">"amount"</span>: <span class="number">120.00</span>,</span><br><span class="line">  <span class="attr">"payment_method"</span>: <span class="string">"wechat"</span>,</span><br><span class="line">  <span class="attr">"status"</span>: <span class="string">"paid"</span>,</span><br><span class="line">  <span class="attr">"pay_time"</span>: <span class="string">"2017-07-07 10:53:50"</span>,</span><br><span class="line">  <span class="attr">"order_id"</span>: <span class="string">"2018327230129"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="signature-服务器端签名-1"><a href="#signature-服务器端签名-1" class="headerlink" title="signature 服务器端签名"></a>signature 服务器端签名</h4><p>服务器端返回结果前会对支付结果加密，商户端需要进行验证，以保证该请求的合法性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">加密文本: merchant_reference + payment_method + status + currency + amount</span><br><span class="line">密钥: api_key</span><br></pre></td></tr></table></figure>

  
  <div class="footer">
  </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- main custom script for sidebars, version selects etc. -->
    <script src="/js/css.escape.js"></script>
    <script src="/js/common.js"></script>


    <!-- fastclick -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
    </script>
  </body>
</html>
